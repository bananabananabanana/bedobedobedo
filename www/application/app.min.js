function config(t,e,n){t.state("login",{url:"/login",templateUrl:"/templates/login.html"}).state("main",{url:"/main","abstract":!0,templateUrl:"/templates/main.html",controller:"MainController"}).state("main.profile",{url:"/profile",views:{main:{templateUrl:"/templates/main.profile.html",controller:"ProfileController"}}}).state("main.friends",{url:"/friend","abstract":!1,views:{main:{templateUrl:"/templates/main.friend.html",controller:"FriendController"}}}),e.otherwise("/main/friend"),n.html5Mode(!0).hashPrefix("!")}function FriendController(t,e,n,i,o,r){t.swap={},t.swap.quantity=0,t.swap.date=new Date,t.swap.current=new Date,t.swap.current.setDate(t.swap.current.getDate()+1),t.disabledButton=function(){return t.swap.quantity<1||void 0==t.swap.date||t.swap.date<t.swap.current},t.tabIndex=0,t.setTab=function(e){switch(t.slideIndex=e,t.slideIndex){case 0:t.getFriendsOnline();break;case 1:t.getFriends()}o.select(t.slideIndex),i.scrollTop()},t.getFriendsOnline=function(){r.getFriendsOnline(function(e){t.friends=e})},t.getFriends=function(){r.getFriends(function(e){t.friends=e})},t.getFriend=function(e){r.getFriendById(e,function(e){t.friend=e})},t.showModal=function(n){t.getFriend(n.id),e.fromTemplateUrl("/templates/main.friend.modal.html",{scope:t}).then(function(e){t.modal=e,t.modal.show()})},t.hideModal=function(){t.modal.hide().then(function(){t.friend={},t.swap.quantity=0,t.swap.date=new Date})},t.refreshFriends=function(){switch(t.slideIndex){case 0:t.getFriendsOnline();break;case 1:t.getFriends()}t.$broadcast("scroll.refreshComplete")},t.refreshFriend=function(e){t.getFriend(e),t.$broadcast("scroll.refreshComplete")},t.giveConfirm=function(){var e=t.swap.date.toISOString().substr(0,10);n.confirm({title:"Одолжить "+t.swap.quantity+" до "+e+"?",subTitle:"Будет отправлен запрос",buttons:[{text:"Отмена"},{text:"ОК",type:"button-positive",onTap:function(){return!0}}]}).then(function(n){n&&r.giveMoney(t.friend.id,t.swap.quantity,e,function(n){n&&(t.friend.debtor.push({id:1,quantity:t.swap.quantity,endDate:e,confirm:!1,close:!1,cancel:!1}),t.swap.quantity=0,t.swap.date=new Date)})})},t.creditorConfirm=function(e){n.confirm({title:"Подтвердить?",buttons:[{text:"Нет",onTap:function(){e.cancel=!0,t.friend.cancel.creditor.push(e),t.friend.creditor.splice(t.friend.creditor.indexOf(e),1)}},{text:"X",type:"button-clear"},{text:"Да",type:"button-positive",onTap:function(){e.confirm=!0}}]})},t.debtorConfirm=function(e){n.confirm({title:"Подтвердите получение",buttons:[{text:"Отмена"},{text:"Получено",type:"button-positive",onTap:function(){e.close=!0,t.friend.close.debtor.push(e),t.friend.debtor.splice(t.friend.debtor.indexOf(e),1)}}]})}}function LoginController(t){}function MainController(t,e){}function ProfileController(t,e,n,i,o){t.swap={},t.swap.quantity=0,t.swap.date=new Date,t.swap.current=new Date,t.swap.current.setDate(t.swap.current.getDate()+1),t.disabledButton=function(){return t.swap.quantity<1||void 0==t.swap.date||t.swap.date<t.swap.current},t.getProfile=function(){i.getProfile(function(e){t.profile=e,console.log(t.profile)})},t.getFriend=function(e){o.getFriendById(e,function(e){t.friend=e})},t.showModal=function(n){t.getFriend(n),e.fromTemplateUrl("/templates/main.friend.modal.html",{scope:t}).then(function(e){t.modal=e,t.modal.show()})},t.hideModal=function(){t.modal.hide().then(function(){t.friend={},t.swap.quantity=0,t.swap.date=new Date})},t.refreshFriend=function(e){t.getFriend(e),t.$broadcast("scroll.refreshComplete")},t.giveConfirm=function(){var e=t.swap.date.toISOString().substr(0,10);n.confirm({title:"Одолжить "+t.swap.quantity+" до "+e+"?",subTitle:"Будет отправлен запрос",buttons:[{text:"Отмена"},{text:"ОК",type:"button-positive",onTap:function(){return!0}}]}).then(function(n){n&&o.giveMoney(t.friend.id,t.swap.quantity,e,function(n){n&&(t.friend.debtor.push({id:1,quantity:t.swap.quantity,endDate:e,confirm:!1,close:!1,cancel:!1}),t.swap.quantity=0,t.swap.date=new Date)})})},t.creditorConfirm=function(e){n.confirm({title:"Подтвердить?",buttons:[{text:"Нет",onTap:function(){e.cancel=!0,t.friend.cancel.creditor.push(e),t.friend.creditor.splice(t.friend.creditor.indexOf(e),1)}},{text:"X",type:"button-clear"},{text:"Да",type:"button-positive",onTap:function(){e.confirm=!0}}]})},t.debtorConfirm=function(e){n.confirm({title:"Подтвердите получение",buttons:[{text:"Отмена"},{text:"Получено",type:"button-positive",onTap:function(){e.close=!0,t.friend.close.debtor.push(e),t.friend.debtor.splice(t.friend.debtor.indexOf(e),1)}}]})}}function Friend(t){this.getFriendsOnline=function(t){for(var e=[],n=0;5>n;n++)e[n]={id:n,image:"http://placehold.it/40x40",fullname:"Друг "+n,rating:Math.round(99*Math.random()+1),quantity:Math.round(4*Math.random()),vkid:1639840};t(e)},this.getFriends=function(t){for(var e=[],n=0;15>n;n++)e[n]={id:n,image:"http://placehold.it/40x40",fullname:"Друг "+n,rating:Math.round(99*Math.random()+1)};t(e)},this.getFriendById=function(t,e){var n={id:t,fullname:"Друг "+t,image:"http://placehold.it/100x100",rating:Math.round(99*Math.random()+1),vkid:1639840,creditor:[{quantity:300,date:"2011-01-01",endDate:"2011-01-01",confirm:!1,close:!1,cancel:!1},{quantity:600,date:"2011-01-01",endDate:"2011-01-01",confirm:!0,close:!0,cancel:!1}],debtor:[{quantity:300,date:"2011-01-01",endDate:"2011-01-01",confirm:!1,close:!1,cancel:!1},{quantity:600,date:"2011-01-01",endDate:"2011-01-01",confirm:!0,close:!0,cancel:!1},{quantity:600,date:"2011-01-01",endDate:"2011-01-01",confirm:!0,closed:!1,cancel:!1},{quantity:600,date:"2011-01-01",endDate:"2011-01-01",confirm:!0,close:!0,cancel:!1}]},i={creditor:[],debtor:[]},o={creditor:[],debtor:[]};angular.forEach(n.creditor,function(t,e){t.close&&(i.creditor.push(t),n.creditor.splice(e,1)),t.cancel&&(o.creditor.push(t),n.creditor.splice(e,1))}),angular.forEach(n.debtor,function(t,e){t.close&&(i.debtor.push(t),n.debtor.splice(e,1)),t.cancel&&(o.debtor.push(t),n.debtor.splice(e,1))}),n.close=i,n.cancel=o,e(n)},this.giveMoney=function(t,e,n,i){console.log(t,e,n),i(!0)}}function Profile(t){this.getProfile=function(t){var e={id:Math.round(999*Math.random()+1),creditors:[{id:Math.round(999*Math.random()+1),fullname:"Друг "+Math.round(99*Math.random()+1),image:"http://placehold.it/400x400"},{id:Math.round(999*Math.random()+1),fullname:"Друг "+Math.round(99*Math.random()+1),image:"http://placehold.it/400x400"}],debtors:[{id:Math.round(999*Math.random()+1),fullname:"Друг "+Math.round(99*Math.random()+1),image:"http://placehold.it/400x400"},{id:Math.round(999*Math.random()+1),fullname:"Друг "+Math.round(99*Math.random()+1),image:"http://placehold.it/400x400"}],image:"http://placehold.it/400x400",fullname:"Василий Пупкин",rating:Math.round(99*Math.random()+1)};t(e)}}angular.module("app",["ionic"]).config(config).controller({LoginController:LoginController,MainController:MainController,ProfileController:ProfileController,FriendController:FriendController}).service({Friend:Friend,Profile:Profile}),config.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],FriendController.$inject=["$scope","$ionicModal","$ionicPopup","$ionicScrollDelegate","$ionicTabsDelegate","Friend"],LoginController.$inject=["$scope","$location"],MainController.$inject=["$scope","$ionicSideMenuDelegate"],ProfileController.$inject=["$scope","$ionicModal","$ionicPopup","Profile","Friend"],Friend.$inject=["$http"],Profile.$inject=["$http"];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvY29uZmlnLmpzIiwic2NyaXB0cy9jb250cm9sbGVycy9GcmllbmRDb250cm9sbGVyLmpzIiwic2NyaXB0cy9jb250cm9sbGVycy9Mb2dpbkNvbnRyb2xsZXIuanMiLCJzY3JpcHRzL2NvbnRyb2xsZXJzL01haW5Db250cm9sbGVyLmpzIiwic2NyaXB0cy9jb250cm9sbGVycy9Qcm9maWxlQ29udHJvbGxlci5qcyIsInNjcmlwdHMvc2VydmljZXMvRnJpZW5kLmpzIiwic2NyaXB0cy9zZXJ2aWNlcy9Qcm9maWxlLmpzIiwic2NyaXB0cy9hcHAuanMiXSwibmFtZXMiOlsiY29uZmlnIiwic3RhdGVQcm92aWRlciIsInVybFJvdXRlclByb3ZpZGVyIiwibG9jYXRpb25Qcm92aWRlciIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJhYnN0cmFjdCIsImNvbnRyb2xsZXIiLCJ2aWV3cyIsIm1haW4iLCJvdGhlcndpc2UiLCJodG1sNU1vZGUiLCJoYXNoUHJlZml4IiwiRnJpZW5kQ29udHJvbGxlciIsInNjb3BlIiwibW9kYWwiLCJwb3B1cCIsInNjcm9sbCIsInRhYnMiLCJGcmllbmQiLCJzd2FwIiwicXVhbnRpdHkiLCJkYXRlIiwiRGF0ZSIsImN1cnJlbnQiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRpc2FibGVkQnV0dG9uIiwidW5kZWZpbmVkIiwidGFiSW5kZXgiLCJzZXRUYWIiLCJpbmRleCIsInNsaWRlSW5kZXgiLCJnZXRGcmllbmRzT25saW5lIiwiZ2V0RnJpZW5kcyIsInNlbGVjdCIsInNjcm9sbFRvcCIsImZyaWVuZHMiLCJnZXRGcmllbmQiLCJmcmllbmRJZCIsImdldEZyaWVuZEJ5SWQiLCJmcmllbmQiLCJzaG93TW9kYWwiLCJpZCIsImZyb21UZW1wbGF0ZVVybCIsInRoZW4iLCJmcmllbmRNb2RhbCIsInNob3ciLCJoaWRlTW9kYWwiLCJoaWRlIiwicmVmcmVzaEZyaWVuZHMiLCIkYnJvYWRjYXN0IiwicmVmcmVzaEZyaWVuZCIsImdpdmVDb25maXJtIiwidG9JU09TdHJpbmciLCJzdWJzdHIiLCJjb25maXJtIiwidGl0bGUiLCJzdWJUaXRsZSIsImJ1dHRvbnMiLCJ0ZXh0IiwidHlwZSIsIm9uVGFwIiwicmVzdWx0IiwiZ2l2ZU1vbmV5IiwiZGVidG9yIiwicHVzaCIsImVuZERhdGUiLCJjbG9zZSIsImNhbmNlbCIsImNyZWRpdG9yQ29uZmlybSIsImNyZWRpdG9yIiwic3BsaWNlIiwiaW5kZXhPZiIsImRlYnRvckNvbmZpcm0iLCJMb2dpbkNvbnRyb2xsZXIiLCJNYWluQ29udHJvbGxlciIsInNpZGVNZW51RGVsZWdhdGUiLCJQcm9maWxlQ29udHJvbGxlciIsIlByb2ZpbGUiLCJnZXRQcm9maWxlIiwicHJvZmlsZSIsImNvbnNvbGUiLCJsb2ciLCJodHRwIiwidGhpcyIsImNhbGxiYWNrIiwiZGF0YSIsImkiLCJpbWFnZSIsImZ1bGxuYW1lIiwicmF0aW5nIiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwidmtpZCIsImNsb3NlZCIsImFuZ3VsYXIiLCJmb3JFYWNoIiwidXNlcklkIiwiY3JlZGl0b3JzIiwiZGVidG9ycyIsIm1vZHVsZSIsInNlcnZpY2UiLCIkaW5qZWN0Il0sIm1hcHBpbmdzIjoiQUFDQSxRQUFBQSxRQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUNBRyxNQUFBLFNBQ0FDLElBQUEsU0FDQUMsWUFBQSwwQkFFQUYsTUFBQSxRQUNBQyxJQUFBLFFBQ0FFLFlBQUEsRUFDQUQsWUFBQSx1QkFDQUUsV0FBQSxtQkFFQUosTUFBQSxnQkFDQUMsSUFBQSxXQUNBSSxPQUNBQyxNQUNBSixZQUFBLCtCQUNBRSxXQUFBLHdCQUlBSixNQUFBLGdCQUNBQyxJQUFBLFVBQ0FFLFlBQUEsRUFDQUUsT0FDQUMsTUFDQUosWUFBQSw4QkFDQUUsV0FBQSx1QkFLQU4sRUFBQVMsVUFBQSxnQkFDQVIsRUFBQVMsV0FBQSxHQUFBQyxXQUFBLEtDMUJBLFFBQUFDLGtCQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBTCxFQUFBTSxRQUNBTixFQUFBTSxLQUFBQyxTQUFBLEVBQ0FQLEVBQUFNLEtBQUFFLEtBQUEsR0FBQUMsTUFDQVQsRUFBQU0sS0FBQUksUUFBQSxHQUFBRCxNQUNBVCxFQUFBTSxLQUFBSSxRQUFBQyxRQUFBWCxFQUFBTSxLQUFBSSxRQUFBRSxVQUFBLEdBRUFaLEVBQUFhLGVBQUEsV0FDQSxNQUFBYixHQUFBTSxLQUFBQyxTQUFBLEdBQUFPLFFBQUFkLEVBQUFNLEtBQUFFLE1BQUFSLEVBQUFNLEtBQUFFLEtBQUFSLEVBQUFNLEtBQUFJLFNBR0FWLEVBQUFlLFNBQUEsRUFDQWYsRUFBQWdCLE9BQUEsU0FBQUMsR0FHQSxPQUZBakIsRUFBQWtCLFdBQUFELEVBRUFqQixFQUFBa0IsWUFDQSxJQUFBLEdBQ0FsQixFQUFBbUIsa0JBQ0EsTUFDQSxLQUFBLEdBQ0FuQixFQUFBb0IsYUFJQWhCLEVBQUFpQixPQUFBckIsRUFBQWtCLFlBQ0FmLEVBQUFtQixhQUdBdEIsRUFBQW1CLGlCQUFBLFdBQ0FkLEVBQUFjLGlCQUFBLFNBQUFJLEdBQ0F2QixFQUFBdUIsUUFBQUEsS0FJQXZCLEVBQUFvQixXQUFBLFdBQ0FmLEVBQUFlLFdBQUEsU0FBQUcsR0FDQXZCLEVBQUF1QixRQUFBQSxLQUlBdkIsRUFBQXdCLFVBQUEsU0FBQUMsR0FDQXBCLEVBQUFxQixjQUFBRCxFQUFBLFNBQUFFLEdBQ0EzQixFQUFBMkIsT0FBQUEsS0FJQTNCLEVBQUE0QixVQUFBLFNBQUFELEdBQ0EzQixFQUFBd0IsVUFBQUcsRUFBQUUsSUFFQTVCLEVBQUE2QixnQkFBQSxxQ0FDQTlCLE1BQUFBLElBQ0ErQixLQUFBLFNBQUFDLEdBQ0FoQyxFQUFBQyxNQUFBK0IsRUFDQWhDLEVBQUFDLE1BQUFnQyxVQUlBakMsRUFBQWtDLFVBQUEsV0FDQWxDLEVBQUFDLE1BQUFrQyxPQUFBSixLQUFBLFdBQ0EvQixFQUFBMkIsVUFDQTNCLEVBQUFNLEtBQUFDLFNBQUEsRUFDQVAsRUFBQU0sS0FBQUUsS0FBQSxHQUFBQyxTQUlBVCxFQUFBb0MsZUFBQSxXQUNBLE9BQUFwQyxFQUFBa0IsWUFDQSxJQUFBLEdBQ0FsQixFQUFBbUIsa0JBQ0EsTUFDQSxLQUFBLEdBQ0FuQixFQUFBb0IsYUFJQXBCLEVBQUFxQyxXQUFBLDJCQUdBckMsRUFBQXNDLGNBQUEsU0FBQWIsR0FDQXpCLEVBQUF3QixVQUFBQyxHQUNBekIsRUFBQXFDLFdBQUEsMkJBR0FyQyxFQUFBdUMsWUFBQSxXQUNBLEdBQUEvQixHQUFBUixFQUFBTSxLQUFBRSxLQUFBZ0MsY0FBQUMsT0FBQSxFQUFBLEdBRUF2QyxHQUFBd0MsU0FDQUMsTUFBQSxZQUFBM0MsRUFBQU0sS0FBQUMsU0FBQSxPQUFBQyxFQUFBLElBQ0FvQyxTQUFBLHlCQUNBQyxVQUVBQyxLQUFBLFdBR0FBLEtBQUEsS0FDQUMsS0FBQSxrQkFDQUMsTUFBQSxXQUNBLE9BQUEsT0FJQWpCLEtBQUEsU0FBQWtCLEdBQ0FBLEdBQ0E1QyxFQUFBNkMsVUFBQWxELEVBQUEyQixPQUFBRSxHQUFBN0IsRUFBQU0sS0FBQUMsU0FBQUMsRUFBQSxTQUFBeUMsR0FDQUEsSUFDQWpELEVBQUEyQixPQUFBd0IsT0FBQUMsTUFDQXZCLEdBQUEsRUFDQXRCLFNBQUFQLEVBQUFNLEtBQUFDLFNBQ0E4QyxRQUFBN0MsRUFDQWtDLFNBQUEsRUFDQVksT0FBQSxFQUNBQyxRQUFBLElBR0F2RCxFQUFBTSxLQUFBQyxTQUFBLEVBQ0FQLEVBQUFNLEtBQUFFLEtBQUEsR0FBQUMsWUFPQVQsRUFBQXdELGdCQUFBLFNBQUFDLEdBQ0F2RCxFQUFBd0MsU0FDQUMsTUFBQSxlQUNBRSxVQUVBQyxLQUFBLE1BQ0FFLE1BQUEsV0FFQVMsRUFBQUYsUUFBQSxFQUVBdkQsRUFBQTJCLE9BQUE0QixPQUFBRSxTQUFBTCxLQUFBSyxHQUVBekQsRUFBQTJCLE9BQUE4QixTQUFBQyxPQUFBMUQsRUFBQTJCLE9BQUE4QixTQUFBRSxRQUFBRixHQUFBLE1BSUFYLEtBQUEsSUFDQUMsS0FBQSxpQkFHQUQsS0FBQSxLQUNBQyxLQUFBLGtCQUNBQyxNQUFBLFdBQ0FTLEVBQUFmLFNBQUEsUUFPQTFDLEVBQUE0RCxjQUFBLFNBQUFULEdBRUFqRCxFQUFBd0MsU0FDQUMsTUFBQSx3QkFDQUUsVUFFQUMsS0FBQSxXQUdBQSxLQUFBLFdBQ0FDLEtBQUEsa0JBQ0FDLE1BQUEsV0FFQUcsRUFBQUcsT0FBQSxFQUVBdEQsRUFBQTJCLE9BQUEyQixNQUFBSCxPQUFBQyxLQUFBRCxHQUVBbkQsRUFBQTJCLE9BQUF3QixPQUFBTyxPQUFBMUQsRUFBQTJCLE9BQUF3QixPQUFBUSxRQUFBUixHQUFBLFNDaExBLFFBQUFVLGlCQUFBN0QsSUNBQSxRQUFBOEQsZ0JBQUE5RCxFQUFBK0QsSUNNQSxRQUFBQyxtQkFBQWhFLEVBQUFDLEVBQUFDLEVBQUErRCxFQUFBNUQsR0FDQUwsRUFBQU0sUUFDQU4sRUFBQU0sS0FBQUMsU0FBQSxFQUNBUCxFQUFBTSxLQUFBRSxLQUFBLEdBQUFDLE1BQ0FULEVBQUFNLEtBQUFJLFFBQUEsR0FBQUQsTUFDQVQsRUFBQU0sS0FBQUksUUFBQUMsUUFBQVgsRUFBQU0sS0FBQUksUUFBQUUsVUFBQSxHQUVBWixFQUFBYSxlQUFBLFdBQ0EsTUFBQWIsR0FBQU0sS0FBQUMsU0FBQSxHQUFBTyxRQUFBZCxFQUFBTSxLQUFBRSxNQUFBUixFQUFBTSxLQUFBRSxLQUFBUixFQUFBTSxLQUFBSSxTQUdBVixFQUFBa0UsV0FBQSxXQUNBRCxFQUFBQyxXQUFBLFNBQUFDLEdBQ0FuRSxFQUFBbUUsUUFBQUEsRUFDQUMsUUFBQUMsSUFBQXJFLEVBQUFtRSxZQUlBbkUsRUFBQXdCLFVBQUEsU0FBQUMsR0FDQXBCLEVBQUFxQixjQUFBRCxFQUFBLFNBQUFFLEdBQ0EzQixFQUFBMkIsT0FBQUEsS0FJQTNCLEVBQUE0QixVQUFBLFNBQUFILEdBQ0F6QixFQUFBd0IsVUFBQUMsR0FFQXhCLEVBQUE2QixnQkFBQSxxQ0FDQTlCLE1BQUFBLElBQ0ErQixLQUFBLFNBQUFDLEdBQ0FoQyxFQUFBQyxNQUFBK0IsRUFDQWhDLEVBQUFDLE1BQUFnQyxVQUlBakMsRUFBQWtDLFVBQUEsV0FDQWxDLEVBQUFDLE1BQUFrQyxPQUFBSixLQUFBLFdBQ0EvQixFQUFBMkIsVUFDQTNCLEVBQUFNLEtBQUFDLFNBQUEsRUFDQVAsRUFBQU0sS0FBQUUsS0FBQSxHQUFBQyxTQUlBVCxFQUFBc0MsY0FBQSxTQUFBYixHQUNBekIsRUFBQXdCLFVBQUFDLEdBQ0F6QixFQUFBcUMsV0FBQSwyQkFHQXJDLEVBQUF1QyxZQUFBLFdBQ0EsR0FBQS9CLEdBQUFSLEVBQUFNLEtBQUFFLEtBQUFnQyxjQUFBQyxPQUFBLEVBQUEsR0FFQXZDLEdBQUF3QyxTQUNBQyxNQUFBLFlBQUEzQyxFQUFBTSxLQUFBQyxTQUFBLE9BQUFDLEVBQUEsSUFDQW9DLFNBQUEseUJBQ0FDLFVBRUFDLEtBQUEsV0FHQUEsS0FBQSxLQUNBQyxLQUFBLGtCQUNBQyxNQUFBLFdBQ0EsT0FBQSxPQUlBakIsS0FBQSxTQUFBa0IsR0FDQUEsR0FDQTVDLEVBQUE2QyxVQUFBbEQsRUFBQTJCLE9BQUFFLEdBQUE3QixFQUFBTSxLQUFBQyxTQUFBQyxFQUFBLFNBQUF5QyxHQUNBQSxJQUNBakQsRUFBQTJCLE9BQUF3QixPQUFBQyxNQUNBdkIsR0FBQSxFQUNBdEIsU0FBQVAsRUFBQU0sS0FBQUMsU0FDQThDLFFBQUE3QyxFQUNBa0MsU0FBQSxFQUNBWSxPQUFBLEVBQ0FDLFFBQUEsSUFHQXZELEVBQUFNLEtBQUFDLFNBQUEsRUFDQVAsRUFBQU0sS0FBQUUsS0FBQSxHQUFBQyxZQU9BVCxFQUFBd0QsZ0JBQUEsU0FBQUMsR0FDQXZELEVBQUF3QyxTQUNBQyxNQUFBLGVBQ0FFLFVBRUFDLEtBQUEsTUFDQUUsTUFBQSxXQUVBUyxFQUFBRixRQUFBLEVBRUF2RCxFQUFBMkIsT0FBQTRCLE9BQUFFLFNBQUFMLEtBQUFLLEdBRUF6RCxFQUFBMkIsT0FBQThCLFNBQUFDLE9BQUExRCxFQUFBMkIsT0FBQThCLFNBQUFFLFFBQUFGLEdBQUEsTUFJQVgsS0FBQSxJQUNBQyxLQUFBLGlCQUdBRCxLQUFBLEtBQ0FDLEtBQUEsa0JBQ0FDLE1BQUEsV0FDQVMsRUFBQWYsU0FBQSxRQU9BMUMsRUFBQTRELGNBQUEsU0FBQVQsR0FFQWpELEVBQUF3QyxTQUNBQyxNQUFBLHdCQUNBRSxVQUVBQyxLQUFBLFdBR0FBLEtBQUEsV0FDQUMsS0FBQSxrQkFDQUMsTUFBQSxXQUVBRyxFQUFBRyxPQUFBLEVBRUF0RCxFQUFBMkIsT0FBQTJCLE1BQUFILE9BQUFDLEtBQUFELEdBRUFuRCxFQUFBMkIsT0FBQXdCLE9BQUFPLE9BQUExRCxFQUFBMkIsT0FBQXdCLE9BQUFRLFFBQUFSLEdBQUEsU0M1SUEsUUFBQTlDLFFBQUFpRSxHQUNBQyxLQUFBcEQsaUJBQUEsU0FBQXFELEdBR0EsSUFBQSxHQUZBQyxNQUVBQyxFQUFBLEVBQUEsRUFBQUEsRUFBQUEsSUFDQUQsRUFBQUMsSUFDQTdDLEdBQUE2QyxFQUNBQyxNQUFBLDRCQUNBQyxTQUFBLFFBQUFGLEVBQ0FHLE9BQUFDLEtBQUFDLE1BQUEsR0FBQUQsS0FBQUUsU0FBQSxHQUNBekUsU0FBQXVFLEtBQUFDLE1BQUEsRUFBQUQsS0FBQUUsVUFDQUMsS0FBQSxRQUlBVCxHQUFBQyxJQUdBRixLQUFBbkQsV0FBQSxTQUFBb0QsR0FHQSxJQUFBLEdBRkFDLE1BRUFDLEVBQUEsRUFBQSxHQUFBQSxFQUFBQSxJQUNBRCxFQUFBQyxJQUNBN0MsR0FBQTZDLEVBQ0FDLE1BQUEsNEJBQ0FDLFNBQUEsUUFBQUYsRUFDQUcsT0FBQUMsS0FBQUMsTUFBQSxHQUFBRCxLQUFBRSxTQUFBLEdBSUFSLEdBQUFDLElBR0FGLEtBQUE3QyxjQUFBLFNBQUFELEVBQUErQyxHQUVBLEdBQUE3QyxJQUNBRSxHQUFBSixFQUNBbUQsU0FBQSxRQUFBbkQsRUFDQWtELE1BQUEsOEJBQ0FFLE9BQUFDLEtBQUFDLE1BQUEsR0FBQUQsS0FBQUUsU0FBQSxHQUNBQyxLQUFBLFFBQ0F4QixXQUVBbEQsU0FBQSxJQUNBQyxLQUFBLGFBQ0E2QyxRQUFBLGFBQ0FYLFNBQUEsRUFDQVksT0FBQSxFQUNBQyxRQUFBLElBR0FoRCxTQUFBLElBQ0FDLEtBQUEsYUFDQTZDLFFBQUEsYUFDQVgsU0FBQSxFQUNBWSxPQUFBLEVBQ0FDLFFBQUEsSUFHQUosU0FFQTVDLFNBQUEsSUFDQUMsS0FBQSxhQUNBNkMsUUFBQSxhQUNBWCxTQUFBLEVBQ0FZLE9BQUEsRUFDQUMsUUFBQSxJQUdBaEQsU0FBQSxJQUNBQyxLQUFBLGFBQ0E2QyxRQUFBLGFBQ0FYLFNBQUEsRUFDQVksT0FBQSxFQUNBQyxRQUFBLElBR0FoRCxTQUFBLElBQ0FDLEtBQUEsYUFDQTZDLFFBQUEsYUFDQVgsU0FBQSxFQUNBd0MsUUFBQSxFQUNBM0IsUUFBQSxJQUdBaEQsU0FBQSxJQUNBQyxLQUFBLGFBQ0E2QyxRQUFBLGFBQ0FYLFNBQUEsRUFDQVksT0FBQSxFQUNBQyxRQUFBLEtBS0FELEdBQ0FHLFlBQ0FOLFdBRUFJLEdBQ0FFLFlBQ0FOLFVBRUFnQyxTQUFBQyxRQUFBekQsRUFBQThCLFNBQUEsU0FBQUEsRUFBQXhDLEdBQ0F3QyxFQUFBSCxRQUNBQSxFQUFBRyxTQUFBTCxLQUFBSyxHQUNBOUIsRUFBQThCLFNBQUFDLE9BQUF6QyxFQUFBLElBR0F3QyxFQUFBRixTQUNBQSxFQUFBRSxTQUFBTCxLQUFBSyxHQUNBOUIsRUFBQThCLFNBQUFDLE9BQUF6QyxFQUFBLE1BR0FrRSxRQUFBQyxRQUFBekQsRUFBQXdCLE9BQUEsU0FBQUEsRUFBQWxDLEdBQ0FrQyxFQUFBRyxRQUNBQSxFQUFBSCxPQUFBQyxLQUFBRCxHQUNBeEIsRUFBQXdCLE9BQUFPLE9BQUF6QyxFQUFBLElBR0FrQyxFQUFBSSxTQUNBQSxFQUFBSixPQUFBQyxLQUFBRCxHQUNBeEIsRUFBQXdCLE9BQUFPLE9BQUF6QyxFQUFBLE1BSUFVLEVBQUEyQixNQUFBQSxFQUNBM0IsRUFBQTRCLE9BQUFBLEVBQ0FpQixFQUFBN0MsSUFHQTRDLEtBQUFyQixVQUFBLFNBQUFtQyxFQUFBOUUsRUFBQUMsRUFBQWdFLEdBQ0FKLFFBQUFDLElBQUFnQixFQUFBOUUsRUFBQUMsR0FDQWdFLEdBQUEsSUNySUEsUUFBQVAsU0FBQUssR0FDQUMsS0FBQUwsV0FBQSxTQUFBTSxHQUNBLEdBQUFDLElBQ0E1QyxHQUFBaUQsS0FBQUMsTUFBQSxJQUFBRCxLQUFBRSxTQUFBLEdBQ0FNLFlBRUF6RCxHQUFBaUQsS0FBQUMsTUFBQSxJQUFBRCxLQUFBRSxTQUFBLEdBQ0FKLFNBQUEsUUFBQUUsS0FBQUMsTUFBQSxHQUFBRCxLQUFBRSxTQUFBLEdBQ0FMLE1BQUEsZ0NBR0E5QyxHQUFBaUQsS0FBQUMsTUFBQSxJQUFBRCxLQUFBRSxTQUFBLEdBQ0FKLFNBQUEsUUFBQUUsS0FBQUMsTUFBQSxHQUFBRCxLQUFBRSxTQUFBLEdBQ0FMLE1BQUEsZ0NBR0FZLFVBRUExRCxHQUFBaUQsS0FBQUMsTUFBQSxJQUFBRCxLQUFBRSxTQUFBLEdBQ0FKLFNBQUEsUUFBQUUsS0FBQUMsTUFBQSxHQUFBRCxLQUFBRSxTQUFBLEdBQ0FMLE1BQUEsZ0NBR0E5QyxHQUFBaUQsS0FBQUMsTUFBQSxJQUFBRCxLQUFBRSxTQUFBLEdBQ0FKLFNBQUEsUUFBQUUsS0FBQUMsTUFBQSxHQUFBRCxLQUFBRSxTQUFBLEdBQ0FMLE1BQUEsZ0NBR0FBLE1BQUEsOEJBQ0FDLFNBQUEsaUJBQ0FDLE9BQUFDLEtBQUFDLE1BQUEsR0FBQUQsS0FBQUUsU0FBQSxHQUVBUixHQUFBQyxJQ2pDQVUsUUFBQUssT0FBQSxPQUFBLFVBQ0F2RyxPQUFBQSxRQUNBUSxZQUNBb0UsZ0JBQUFBLGdCQUNBQyxlQUFBQSxlQUNBRSxrQkFBQUEsa0JBQ0FqRSxpQkFBQUEsbUJBRUEwRixTQUNBcEYsT0FBQUEsT0FDQTRELFFBQUFBLFVQVkFoRixPQUFBeUcsU0FBQSxpQkFBQSxxQkFBQSxxQkNBQTNGLGlCQUFBMkYsU0FDQSxTQUNBLGNBQ0EsY0FDQSx1QkFDQSxxQkFDQSxVQ05BN0IsZ0JBQUE2QixTQUFBLFNBQUEsYUNBQTVCLGVBQUE0QixTQUFBLFNBQUEsMEJDQUExQixrQkFBQTBCLFNBQ0EsU0FDQSxjQUNBLGNBQ0EsVUFDQSxVQ0xBckYsT0FBQXFGLFNBQUEsU0NBQXpCLFFBQUF5QixTQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJ107XG5mdW5jdGlvbiBjb25maWcoc3RhdGVQcm92aWRlciwgdXJsUm91dGVyUHJvdmlkZXIsIGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICBzdGF0ZVByb3ZpZGVyXG4gICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2xvZ2luLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgnbWFpbicsIHtcbiAgICAgICAgICAgIHVybDogJy9tYWluJyxcbiAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL21haW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTWFpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgnbWFpbi5wcm9maWxlJywge1xuICAgICAgICAgICAgdXJsOiAnL3Byb2ZpbGUnLFxuICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9tYWluLnByb2ZpbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgnbWFpbi5mcmllbmRzJywge1xuICAgICAgICAgICAgdXJsOiAnL2ZyaWVuZCcsXG4gICAgICAgICAgICBhYnN0cmFjdDogZmFsc2UsXG4gICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgIG1haW46IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL21haW4uZnJpZW5kLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRnJpZW5kQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvbWFpbi9mcmllbmQnKTtcbiAgICBsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKS5oYXNoUHJlZml4KCchJyk7XG59IiwiRnJpZW5kQ29udHJvbGxlci4kaW5qZWN0ID0gW1xuICAgICckc2NvcGUnLFxuICAgICckaW9uaWNNb2RhbCcsXG4gICAgJyRpb25pY1BvcHVwJyxcbiAgICAnJGlvbmljU2Nyb2xsRGVsZWdhdGUnLFxuICAgICckaW9uaWNUYWJzRGVsZWdhdGUnLFxuICAgICdGcmllbmQnXG5dO1xuZnVuY3Rpb24gRnJpZW5kQ29udHJvbGxlcihzY29wZSwgbW9kYWwsIHBvcHVwLCBzY3JvbGwsIHRhYnMsIEZyaWVuZCkge1xuICAgIHNjb3BlLnN3YXAgPSB7fTtcbiAgICBzY29wZS5zd2FwLnF1YW50aXR5ID0gMDtcbiAgICBzY29wZS5zd2FwLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHNjb3BlLnN3YXAuY3VycmVudCA9IG5ldyBEYXRlKCk7XG4gICAgc2NvcGUuc3dhcC5jdXJyZW50LnNldERhdGUoc2NvcGUuc3dhcC5jdXJyZW50LmdldERhdGUoKSArIDEpO1xuXG4gICAgc2NvcGUuZGlzYWJsZWRCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzY29wZS5zd2FwLnF1YW50aXR5IDwgMSB8fCBzY29wZS5zd2FwLmRhdGUgPT0gdW5kZWZpbmVkIHx8IHNjb3BlLnN3YXAuZGF0ZSA8IHNjb3BlLnN3YXAuY3VycmVudDtcbiAgICB9O1xuXG4gICAgc2NvcGUudGFiSW5kZXggPSAwO1xuICAgIHNjb3BlLnNldFRhYiA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzY29wZS5zbGlkZUluZGV4ID0gaW5kZXg7XG5cbiAgICAgICAgc3dpdGNoIChzY29wZS5zbGlkZUluZGV4KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgc2NvcGUuZ2V0RnJpZW5kc09ubGluZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHNjb3BlLmdldEZyaWVuZHMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHRhYnMuc2VsZWN0KHNjb3BlLnNsaWRlSW5kZXgpO1xuICAgICAgICBzY3JvbGwuc2Nyb2xsVG9wKCk7XG4gICAgfTtcblxuICAgIHNjb3BlLmdldEZyaWVuZHNPbmxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEZyaWVuZC5nZXRGcmllbmRzT25saW5lKGZ1bmN0aW9uIChmcmllbmRzKSB7XG4gICAgICAgICAgICBzY29wZS5mcmllbmRzID0gZnJpZW5kcztcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHNjb3BlLmdldEZyaWVuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEZyaWVuZC5nZXRGcmllbmRzKGZ1bmN0aW9uIChmcmllbmRzKSB7XG4gICAgICAgICAgICBzY29wZS5mcmllbmRzID0gZnJpZW5kcztcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHNjb3BlLmdldEZyaWVuZCA9IGZ1bmN0aW9uIChmcmllbmRJZCkge1xuICAgICAgICBGcmllbmQuZ2V0RnJpZW5kQnlJZChmcmllbmRJZCwgZnVuY3Rpb24gKGZyaWVuZCkge1xuICAgICAgICAgICAgc2NvcGUuZnJpZW5kID0gZnJpZW5kO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgc2NvcGUuc2hvd01vZGFsID0gZnVuY3Rpb24gKGZyaWVuZCkge1xuICAgICAgICBzY29wZS5nZXRGcmllbmQoZnJpZW5kLmlkKTtcblxuICAgICAgICBtb2RhbC5mcm9tVGVtcGxhdGVVcmwoJy90ZW1wbGF0ZXMvbWFpbi5mcmllbmQubW9kYWwuaHRtbCcsIHtcbiAgICAgICAgICAgIHNjb3BlOiBzY29wZVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChmcmllbmRNb2RhbCkge1xuICAgICAgICAgICAgc2NvcGUubW9kYWwgPSBmcmllbmRNb2RhbDtcbiAgICAgICAgICAgIHNjb3BlLm1vZGFsLnNob3coKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHNjb3BlLmhpZGVNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2NvcGUubW9kYWwuaGlkZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2NvcGUuZnJpZW5kID0ge307XG4gICAgICAgICAgICBzY29wZS5zd2FwLnF1YW50aXR5ID0gMDtcbiAgICAgICAgICAgIHNjb3BlLnN3YXAuZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzY29wZS5yZWZyZXNoRnJpZW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3dpdGNoIChzY29wZS5zbGlkZUluZGV4KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgc2NvcGUuZ2V0RnJpZW5kc09ubGluZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHNjb3BlLmdldEZyaWVuZHMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLiRicm9hZGNhc3QoJ3Njcm9sbC5yZWZyZXNoQ29tcGxldGUnKTtcbiAgICB9O1xuXG4gICAgc2NvcGUucmVmcmVzaEZyaWVuZCA9IGZ1bmN0aW9uIChmcmllbmRJZCkge1xuICAgICAgICBzY29wZS5nZXRGcmllbmQoZnJpZW5kSWQpO1xuICAgICAgICBzY29wZS4kYnJvYWRjYXN0KCdzY3JvbGwucmVmcmVzaENvbXBsZXRlJyk7XG4gICAgfTtcblxuICAgIHNjb3BlLmdpdmVDb25maXJtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGF0ZSA9IHNjb3BlLnN3YXAuZGF0ZS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCk7XG5cbiAgICAgICAgcG9wdXAuY29uZmlybSh7XG4gICAgICAgICAgICB0aXRsZTogJ9Ce0LTQvtC70LbQuNGC0YwgJyArIHNjb3BlLnN3YXAucXVhbnRpdHkgKyAnINC00L4gJyArIGRhdGUgKyAnPycsXG4gICAgICAgICAgICBzdWJUaXRsZTogJ9CR0YPQtNC10YIg0L7RgtC/0YDQsNCy0LvQtdC9INC30LDQv9GA0L7RgScsXG4gICAgICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn0J7RgtC80LXQvdCwJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn0J7QmicsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24tcG9zaXRpdmUnLFxuICAgICAgICAgICAgICAgICAgICBvblRhcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIEZyaWVuZC5naXZlTW9uZXkoc2NvcGUuZnJpZW5kLmlkLCBzY29wZS5zd2FwLnF1YW50aXR5LCBkYXRlLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZyaWVuZC5kZWJ0b3IucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkJzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncXVhbnRpdHknOiBzY29wZS5zd2FwLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbmREYXRlJzogZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29uZmlybSc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjbG9zZSc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjYW5jZWwnOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnN3YXAucXVhbnRpdHkgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc3dhcC5kYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgc2NvcGUuY3JlZGl0b3JDb25maXJtID0gZnVuY3Rpb24gKGNyZWRpdG9yKSB7XG4gICAgICAgIHBvcHVwLmNvbmZpcm0oe1xuICAgICAgICAgICAgdGl0bGU6ICfQn9C+0LTRgtCy0LXRgNC00LjRgtGMPycsXG4gICAgICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn0J3QtdGCJyxcbiAgICAgICAgICAgICAgICAgICAgb25UYXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vINC+0YLQvNC10L3Rj9C10LxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRpdG9yLmNhbmNlbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDQtNC+0LHQsNCy0LvRj9C10Lwg0LIg0LzQsNGB0YHQuNCyINC+0YLQvNC10L3QtdC90L3Ri9GFXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5mcmllbmQuY2FuY2VsLmNyZWRpdG9yLnB1c2goY3JlZGl0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g0YPQtNCw0LvRj9C10Lwg0LjQtyDQvtCx0YvRh9C90L7Qs9C+INC80LDRgdGB0LjQstCwXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5mcmllbmQuY3JlZGl0b3Iuc3BsaWNlKHNjb3BlLmZyaWVuZC5jcmVkaXRvci5pbmRleE9mKGNyZWRpdG9yKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ1gnLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYnV0dG9uLWNsZWFyJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn0JTQsCcsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24tcG9zaXRpdmUnLFxuICAgICAgICAgICAgICAgICAgICBvblRhcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGl0b3IuY29uZmlybSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzY29wZS5kZWJ0b3JDb25maXJtID0gZnVuY3Rpb24gKGRlYnRvcikge1xuICAgICAgICAvLyDQtdGB0YLRjCDQv9C+0LTRgtCy0LXRgNC20LTQtdC90LjQtSDRgtC+0LPQviwg0YfRgtC+INCy0LDQvCDQtNC+0LvQttC90YtcbiAgICAgICAgcG9wdXAuY29uZmlybSh7XG4gICAgICAgICAgICB0aXRsZTogJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0L/QvtC70YPRh9C10L3QuNC1JyxcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQntGC0LzQtdC90LAnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQn9C+0LvRg9GH0LXQvdC+JyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbi1wb3NpdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgIG9uVGFwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDQt9Cw0LrRgNGL0LLQsNC10LxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnRvci5jbG9zZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDQtNC+0LHQsNCy0LvRj9C10Lwg0LIg0LzQsNGB0YHQuNCyINC30LDQutGA0YvRgtGL0YVcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZyaWVuZC5jbG9zZS5kZWJ0b3IucHVzaChkZWJ0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g0YPQtNCw0LvRj9C10Lwg0LjQtyDQvtCx0YvRh9C90L7Qs9C+INC80LDRgdGB0LjQstCwXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5mcmllbmQuZGVidG9yLnNwbGljZShzY29wZS5mcmllbmQuZGVidG9yLmluZGV4T2YoZGVidG9yKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgIH07XG59IiwiTG9naW5Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckbG9jYXRpb24nXTtcbmZ1bmN0aW9uIExvZ2luQ29udHJvbGxlcihzY29wZSkge1xufSIsIk1haW5Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckaW9uaWNTaWRlTWVudURlbGVnYXRlJ107XG5mdW5jdGlvbiBNYWluQ29udHJvbGxlcihzY29wZSwgc2lkZU1lbnVEZWxlZ2F0ZSkge1xufSIsIlByb2ZpbGVDb250cm9sbGVyLiRpbmplY3QgPSBbXG4gICAgJyRzY29wZScsXG4gICAgJyRpb25pY01vZGFsJyxcbiAgICAnJGlvbmljUG9wdXAnLFxuICAgICdQcm9maWxlJyxcbiAgICAnRnJpZW5kJ1xuXTtcbmZ1bmN0aW9uIFByb2ZpbGVDb250cm9sbGVyKHNjb3BlLCBtb2RhbCwgcG9wdXAsIFByb2ZpbGUsIEZyaWVuZCkge1xuICAgIHNjb3BlLnN3YXAgPSB7fTtcbiAgICBzY29wZS5zd2FwLnF1YW50aXR5ID0gMDtcbiAgICBzY29wZS5zd2FwLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHNjb3BlLnN3YXAuY3VycmVudCA9IG5ldyBEYXRlKCk7XG4gICAgc2NvcGUuc3dhcC5jdXJyZW50LnNldERhdGUoc2NvcGUuc3dhcC5jdXJyZW50LmdldERhdGUoKSArIDEpO1xuXG4gICAgc2NvcGUuZGlzYWJsZWRCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzY29wZS5zd2FwLnF1YW50aXR5IDwgMSB8fCBzY29wZS5zd2FwLmRhdGUgPT0gdW5kZWZpbmVkIHx8IHNjb3BlLnN3YXAuZGF0ZSA8IHNjb3BlLnN3YXAuY3VycmVudDtcbiAgICB9O1xuXG4gICAgc2NvcGUuZ2V0UHJvZmlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgUHJvZmlsZS5nZXRQcm9maWxlKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICBzY29wZS5wcm9maWxlID0gcHJvZmlsZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNjb3BlLnByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgc2NvcGUuZ2V0RnJpZW5kID0gZnVuY3Rpb24gKGZyaWVuZElkKSB7XG4gICAgICAgIEZyaWVuZC5nZXRGcmllbmRCeUlkKGZyaWVuZElkLCBmdW5jdGlvbiAoZnJpZW5kKSB7XG4gICAgICAgICAgICBzY29wZS5mcmllbmQgPSBmcmllbmQ7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzY29wZS5zaG93TW9kYWwgPSBmdW5jdGlvbiAoZnJpZW5kSWQpIHtcbiAgICAgICAgc2NvcGUuZ2V0RnJpZW5kKGZyaWVuZElkKTtcblxuICAgICAgICBtb2RhbC5mcm9tVGVtcGxhdGVVcmwoJy90ZW1wbGF0ZXMvbWFpbi5mcmllbmQubW9kYWwuaHRtbCcsIHtcbiAgICAgICAgICAgIHNjb3BlOiBzY29wZVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChmcmllbmRNb2RhbCkge1xuICAgICAgICAgICAgc2NvcGUubW9kYWwgPSBmcmllbmRNb2RhbDtcbiAgICAgICAgICAgIHNjb3BlLm1vZGFsLnNob3coKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHNjb3BlLmhpZGVNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2NvcGUubW9kYWwuaGlkZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2NvcGUuZnJpZW5kID0ge307XG4gICAgICAgICAgICBzY29wZS5zd2FwLnF1YW50aXR5ID0gMDtcbiAgICAgICAgICAgIHNjb3BlLnN3YXAuZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzY29wZS5yZWZyZXNoRnJpZW5kID0gZnVuY3Rpb24gKGZyaWVuZElkKSB7XG4gICAgICAgIHNjb3BlLmdldEZyaWVuZChmcmllbmRJZCk7XG4gICAgICAgIHNjb3BlLiRicm9hZGNhc3QoJ3Njcm9sbC5yZWZyZXNoQ29tcGxldGUnKTtcbiAgICB9O1xuXG4gICAgc2NvcGUuZ2l2ZUNvbmZpcm0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRlID0gc2NvcGUuc3dhcC5kYXRlLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKTtcblxuICAgICAgICBwb3B1cC5jb25maXJtKHtcbiAgICAgICAgICAgIHRpdGxlOiAn0J7QtNC+0LvQttC40YLRjCAnICsgc2NvcGUuc3dhcC5xdWFudGl0eSArICcg0LTQviAnICsgZGF0ZSArICc/JyxcbiAgICAgICAgICAgIHN1YlRpdGxlOiAn0JHRg9C00LXRgiDQvtGC0L/RgNCw0LLQu9C10L0g0LfQsNC/0YDQvtGBJyxcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQntGC0LzQtdC90LAnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQntCaJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbi1wb3NpdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgIG9uVGFwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgRnJpZW5kLmdpdmVNb25leShzY29wZS5mcmllbmQuaWQsIHNjb3BlLnN3YXAucXVhbnRpdHksIGRhdGUsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZnJpZW5kLmRlYnRvci5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaWQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdWFudGl0eSc6IHNjb3BlLnN3YXAucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VuZERhdGUnOiBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maXJtJzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Nsb3NlJzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NhbmNlbCc6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc3dhcC5xdWFudGl0eSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5zd2FwLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBzY29wZS5jcmVkaXRvckNvbmZpcm0gPSBmdW5jdGlvbiAoY3JlZGl0b3IpIHtcbiAgICAgICAgcG9wdXAuY29uZmlybSh7XG4gICAgICAgICAgICB0aXRsZTogJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0Yw/JyxcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQndC10YInLFxuICAgICAgICAgICAgICAgICAgICBvblRhcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g0L7RgtC80LXQvdGP0LXQvFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGl0b3IuY2FuY2VsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vINC00L7QsdCw0LLQu9GP0LXQvCDQsiDQvNCw0YHRgdC40LIg0L7RgtC80LXQvdC10L3QvdGL0YVcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZyaWVuZC5jYW5jZWwuY3JlZGl0b3IucHVzaChjcmVkaXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDRg9C00LDQu9GP0LXQvCDQuNC3INC+0LHRi9GH0L3QvtCz0L4g0LzQsNGB0YHQuNCy0LBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZyaWVuZC5jcmVkaXRvci5zcGxpY2Uoc2NvcGUuZnJpZW5kLmNyZWRpdG9yLmluZGV4T2YoY3JlZGl0b3IpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnWCcsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24tY2xlYXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfQlNCwJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbi1wb3NpdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgIG9uVGFwOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVkaXRvci5jb25maXJtID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHNjb3BlLmRlYnRvckNvbmZpcm0gPSBmdW5jdGlvbiAoZGVidG9yKSB7XG4gICAgICAgIC8vINC10YHRgtGMINC/0L7QtNGC0LLQtdGA0LbQtNC10L3QuNC1INGC0L7Qs9C+LCDRh9GC0L4g0LLQsNC8INC00L7Qu9C20L3Ri1xuICAgICAgICBwb3B1cC5jb25maXJtKHtcbiAgICAgICAgICAgIHRpdGxlOiAn0J/QvtC00YLQstC10YDQtNC40YLQtSDQv9C+0LvRg9GH0LXQvdC40LUnLFxuICAgICAgICAgICAgYnV0dG9uczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ9Ce0YLQvNC10L3QsCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ9Cf0L7Qu9GD0YfQtdC90L4nLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYnV0dG9uLXBvc2l0aXZlJyxcbiAgICAgICAgICAgICAgICAgICAgb25UYXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vINC30LDQutGA0YvQstCw0LXQvFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidG9yLmNsb3NlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vINC00L7QsdCw0LLQu9GP0LXQvCDQsiDQvNCw0YHRgdC40LIg0LfQsNC60YDRi9GC0YvRhVxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZnJpZW5kLmNsb3NlLmRlYnRvci5wdXNoKGRlYnRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDRg9C00LDQu9GP0LXQvCDQuNC3INC+0LHRi9GH0L3QvtCz0L4g0LzQsNGB0YHQuNCy0LBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmZyaWVuZC5kZWJ0b3Iuc3BsaWNlKHNjb3BlLmZyaWVuZC5kZWJ0b3IuaW5kZXhPZihkZWJ0b3IpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgfTtcbn0iLCJGcmllbmQuJGluamVjdCA9IFsnJGh0dHAnXTtcbmZ1bmN0aW9uIEZyaWVuZChodHRwKSB7XG4gICAgdGhpcy5nZXRGcmllbmRzT25saW5lID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaV0gPSB7XG4gICAgICAgICAgICAgICAgJ2lkJzogaSxcbiAgICAgICAgICAgICAgICAnaW1hZ2UnOiAnaHR0cDovL3BsYWNlaG9sZC5pdC80MHg0MCcsXG4gICAgICAgICAgICAgICAgJ2Z1bGxuYW1lJzogJ9CU0YDRg9CzICcgKyBpLFxuICAgICAgICAgICAgICAgICdyYXRpbmcnOiBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoMTAwIC0gMSkgKyAxKSxcbiAgICAgICAgICAgICAgICAncXVhbnRpdHknOiBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA0KSxcbiAgICAgICAgICAgICAgICAndmtpZCc6IDE2Mzk4NDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRGcmllbmRzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICBkYXRhW2ldID0ge1xuICAgICAgICAgICAgICAgICdpZCc6IGksXG4gICAgICAgICAgICAgICAgJ2ltYWdlJzogJ2h0dHA6Ly9wbGFjZWhvbGQuaXQvNDB4NDAnLFxuICAgICAgICAgICAgICAgICdmdWxsbmFtZSc6ICfQlNGA0YPQsyAnICsgaSxcbiAgICAgICAgICAgICAgICAncmF0aW5nJzogTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDEwMCAtIDEpICsgMSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRGcmllbmRCeUlkID0gZnVuY3Rpb24gKGZyaWVuZElkLCBjYWxsYmFjaykge1xuICAgICAgICAvLyBjcmVkaXRvciAtINGN0YLQviDRgtC+0YIg0LrRgtC+INC00LDQuyDRgtC10LrRg9GJ0LXQvNGDINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjlxuICAgICAgICB2YXIgZnJpZW5kID0ge1xuICAgICAgICAgICAgJ2lkJzogZnJpZW5kSWQsXG4gICAgICAgICAgICAnZnVsbG5hbWUnOiAn0JTRgNGD0LMgJyArIGZyaWVuZElkLFxuICAgICAgICAgICAgJ2ltYWdlJzogJ2h0dHA6Ly9wbGFjZWhvbGQuaXQvMTAweDEwMCcsXG4gICAgICAgICAgICAncmF0aW5nJzogTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDEwMCAtIDEpICsgMSksXG4gICAgICAgICAgICAndmtpZCc6IDE2Mzk4NDAsXG4gICAgICAgICAgICAnY3JlZGl0b3InOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IDMwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJkYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJjb25maXJtXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBcImNsb3NlXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBcImNhbmNlbFwiOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IDYwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJkYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJjb25maXJtXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwiY2xvc2VcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJjYW5jZWxcIjogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgJ2RlYnRvcic6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIFwicXVhbnRpdHlcIjogMzAwLFxuICAgICAgICAgICAgICAgICAgICBcImRhdGVcIjogJzIwMTEtMDEtMDEnLFxuICAgICAgICAgICAgICAgICAgICBcImVuZERhdGVcIjogJzIwMTEtMDEtMDEnLFxuICAgICAgICAgICAgICAgICAgICBcImNvbmZpcm1cIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIFwiY2xvc2VcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIFwiY2FuY2VsXCI6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIFwicXVhbnRpdHlcIjogNjAwLFxuICAgICAgICAgICAgICAgICAgICBcImRhdGVcIjogJzIwMTEtMDEtMDEnLFxuICAgICAgICAgICAgICAgICAgICBcImVuZERhdGVcIjogJzIwMTEtMDEtMDEnLFxuICAgICAgICAgICAgICAgICAgICBcImNvbmZpcm1cIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJjbG9zZVwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcImNhbmNlbFwiOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IDYwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJkYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJjb25maXJtXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwiY2xvc2VkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBcImNhbmNlbFwiOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcInF1YW50aXR5XCI6IDYwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJkYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6ICcyMDExLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgXCJjb25maXJtXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIFwiY2xvc2VcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJjYW5jZWxcIjogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGNsb3NlID0ge1xuICAgICAgICAgICAgJ2NyZWRpdG9yJzogW10sXG4gICAgICAgICAgICAnZGVidG9yJzogW11cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhbmNlbCA9IHtcbiAgICAgICAgICAgICdjcmVkaXRvcic6IFtdLFxuICAgICAgICAgICAgJ2RlYnRvcic6IFtdXG4gICAgICAgIH07XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChmcmllbmQuY3JlZGl0b3IsIGZ1bmN0aW9uIChjcmVkaXRvciwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChjcmVkaXRvci5jbG9zZSkge1xuICAgICAgICAgICAgICAgIGNsb3NlLmNyZWRpdG9yLnB1c2goY3JlZGl0b3IpO1xuICAgICAgICAgICAgICAgIGZyaWVuZC5jcmVkaXRvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3JlZGl0b3IuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsLmNyZWRpdG9yLnB1c2goY3JlZGl0b3IpO1xuICAgICAgICAgICAgICAgIGZyaWVuZC5jcmVkaXRvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGZyaWVuZC5kZWJ0b3IsIGZ1bmN0aW9uIChkZWJ0b3IsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoZGVidG9yLmNsb3NlKSB7XG4gICAgICAgICAgICAgICAgY2xvc2UuZGVidG9yLnB1c2goZGVidG9yKTtcbiAgICAgICAgICAgICAgICBmcmllbmQuZGVidG9yLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChkZWJ0b3IuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsLmRlYnRvci5wdXNoKGRlYnRvcik7XG4gICAgICAgICAgICAgICAgZnJpZW5kLmRlYnRvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBmcmllbmQuY2xvc2UgPSBjbG9zZTtcbiAgICAgICAgZnJpZW5kLmNhbmNlbCA9IGNhbmNlbDtcbiAgICAgICAgY2FsbGJhY2soZnJpZW5kKTtcbiAgICB9O1xuXG4gICAgdGhpcy5naXZlTW9uZXkgPSBmdW5jdGlvbiAodXNlcklkLCBxdWFudGl0eSwgZGF0ZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc29sZS5sb2codXNlcklkLCBxdWFudGl0eSwgZGF0ZSk7XG4gICAgICAgIGNhbGxiYWNrKHRydWUpO1xuICAgIH07XG59IiwiUHJvZmlsZS4kaW5qZWN0ID0gWyckaHR0cCddO1xuZnVuY3Rpb24gUHJvZmlsZShodHRwKSB7XG4gICAgdGhpcy5nZXRQcm9maWxlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgJ2lkJzogTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDEwMDAgLSAxKSArIDEpLFxuICAgICAgICAgICAgJ2NyZWRpdG9ycyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICgxMDAwIC0gMSkgKyAxKSxcbiAgICAgICAgICAgICAgICAgICAgJ2Z1bGxuYW1lJzogJ9CU0YDRg9CzICcgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoMTAwIC0gMSkgKyAxKSxcbiAgICAgICAgICAgICAgICAgICAgJ2ltYWdlJzogJ2h0dHA6Ly9wbGFjZWhvbGQuaXQvNDAweDQwMCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDEwMDAgLSAxKSArIDEpLFxuICAgICAgICAgICAgICAgICAgICAnZnVsbG5hbWUnOiAn0JTRgNGD0LMgJyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAxKSArIDEpLFxuICAgICAgICAgICAgICAgICAgICAnaW1hZ2UnOiAnaHR0cDovL3BsYWNlaG9sZC5pdC80MDB4NDAwJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnZGVidG9ycyc6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICgxMDAwIC0gMSkgKyAxKSxcbiAgICAgICAgICAgICAgICAgICAgJ2Z1bGxuYW1lJzogJ9CU0YDRg9CzICcgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoMTAwIC0gMSkgKyAxKSxcbiAgICAgICAgICAgICAgICAgICAgJ2ltYWdlJzogJ2h0dHA6Ly9wbGFjZWhvbGQuaXQvNDAweDQwMCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDEwMDAgLSAxKSArIDEpLFxuICAgICAgICAgICAgICAgICAgICAnZnVsbG5hbWUnOiAn0JTRgNGD0LMgJyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAxKSArIDEpLFxuICAgICAgICAgICAgICAgICAgICAnaW1hZ2UnOiAnaHR0cDovL3BsYWNlaG9sZC5pdC80MDB4NDAwJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAnaW1hZ2UnOiAnaHR0cDovL3BsYWNlaG9sZC5pdC80MDB4NDAwJyxcbiAgICAgICAgICAgICdmdWxsbmFtZSc6ICfQktCw0YHQuNC70LjQuSDQn9GD0L/QutC40L0nLFxuICAgICAgICAgICAgJ3JhdGluZyc6IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAxKSArIDEpXG4gICAgICAgIH07XG4gICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgIH07XG59IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnaW9uaWMnXSlcbiAgICAuY29uZmlnKGNvbmZpZylcbiAgICAuY29udHJvbGxlcih7XG4gICAgICAgICdMb2dpbkNvbnRyb2xsZXInOiBMb2dpbkNvbnRyb2xsZXIsXG4gICAgICAgICdNYWluQ29udHJvbGxlcic6IE1haW5Db250cm9sbGVyLFxuICAgICAgICAnUHJvZmlsZUNvbnRyb2xsZXInOiBQcm9maWxlQ29udHJvbGxlcixcbiAgICAgICAgJ0ZyaWVuZENvbnRyb2xsZXInOiBGcmllbmRDb250cm9sbGVyXG4gICAgfSlcbiAgICAuc2VydmljZSh7XG4gICAgICAgICdGcmllbmQnOiBGcmllbmQsXG4gICAgICAgICdQcm9maWxlJzogUHJvZmlsZVxuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==